---
title: 【学习笔记】我们仍未理解那天所学习的数论算法

date: 2023-01-30 09:01:05

description: 本文将会讲解部分数论的知识点和算法。

katex: true

tags:

- 学习笔记
 
categories: 

- OI

- 数学

- 数论

sticky: 2

cover: /img/14.jpg

---

## 前言

对于部分基础的数论知识点（如整除、同余等），笔者不会再进行讲解。因此，笔者希望有扎实的数论基础的读者来阅读这篇文章。

------

## 中国剩余定理

对于线性同余方程组 $x \equiv a_i \pmod{p_i}$，中国剩余定理能够求解其最小非负整数解。

这个算法要分为两种情况讨论，而两种情况的算法实际上存在本质区别。

### 模数两两互质

我们有如下基于构造思想的算法：

设 $\displaystyle \text{M} = \prod_{i = 1}^mp_i$，$\text{M}_i = \dfrac{\text{M}}{p_i}$，$\text{M}_i^{-1}$ 为 $\text{M}_i$ 在模 $p_i$ 意义下的逆元，那么整个方程组的最小非负整数解为 $\displaystyle (\sum_{i = 1}^m a_i\cdot \text{M}_i\cdot \text{M}_i^{-1}) \bmod \text{M}$。

证明：

{% note success flat %}

考虑这个和式的第 $i$ 项 $a_i \cdot \text{M}_i \cdot \text{M}_i^{-1}$，将其对 $p_i$ 取模即得到第 $i$ 个同余方程的特解 $a_i$，而将其对其它的 $p_j~(j \ne i)$ 取模均得到 $0$，所以这个项既能够满足第 $i$ 个同余方程，又不会对其它的同余方程造成影响。

这样，我们证明了这个和式是原方程的一个特解。

又因为方程组在 $[0, \text{M})$ 内仅存在一个解，因此将这个和式对 $\text{M}$ 取模即得到最小非负整数解。

{% endnote %}

值得一提的是，我们熟知的拉格朗日差值实际上是基于这一部分的算法的。

### 模数不两两互质

我们是否能够考虑套用上述算法的框架呢？不行，因为 $\text{M}_i^{-1}$ 甚至有可能根本不存在。因此，仅对上述算法进行微调是不可行的。

我们考虑一个很简单的思想：合并同余方程。

对于前 $i$ 个同余方程，我们可以通过将它们合并得到一个形如 $x \equiv b_i \pmod{\text{M}_i}$ 的方程，这里的 $\text{M}_i$ 表示前 $i$ 个模数的 $\operatorname{lcm}$。

接下来我们考虑其和第 $i + 1$ 个方程的合并。

首先我们将满足前 $i$ 个方程的 $x$ 写成 $b_i + \text{M}_i \cdot k~(k \in \Z)$ 的形式，那么我们仅需求出 $k$ 的一个特解便可得到前 $i + 1$ 个方程的特解，然后将其带入第 $i + 1$ 个方程得到 $b_i +\text{M}_i \cdot k \equiv a_i \pmod{p_i}$，再将其转化为二元一次不定方程的形式，最后用 $\operatorname{exgcd}$ 求出 $k$ 的一个特解即可。在这个过程中，我们还可以判断方程组是否存在无解的情况。

### Bonus 部分

实际上，若我们对于每一个方程，都将 $x$ 带上一个 $c_i$ 的系数，那么无论是上述的哪一种情况，对应的算法经过调整仍然是可行的。

读者不妨自行思考，在 $x$ 带上了系数的情况下，两种情况对应的算法分别应该如何调整。

------

## 未完待续 ……
